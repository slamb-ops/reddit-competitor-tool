<!DOCTYPE html>
<html>
<head>
    <title>Reddit Competitor Analysis</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .competitor { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 5px; }
        button { background: #007cba; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #005a87; }
        .loading { color: #666; font-style: italic; }
    </style>
</head>
<body>
    <h1>Reddit Competitor Analysis</h1>
    <button onclick="analyzeCompetitors()">Analyze Reddit Discussions</button>
    <div id="results"></div>

    <script>
        async function fetchRedditData(query) {
            try {
                const response = await fetch(`https://www.reddit.com/search.json?q=${encodeURIComponent(query)}&limit=20&sort=new`);
                const data = await response.json();
                return data.data.children.map(child => ({
                    title: child.data.title,
                    ups: child.data.ups,
                    subreddit: child.data.subreddit,
                    comments: child.data.num_comments
                }));
            } catch (error) {
                console.error('Error:', error);
                return [];
            }
        }

        async function analyzeCompetitors() {
            document.getElementById('results').innerHTML = '<div class="loading">Analyzing Reddit discussions...</div>';
            
            const competitors = {
                'Medium': 'medium.com',
                'Substack': 'substack',
                'Ghost': 'ghost.org',
                'dev.to': 'dev.to'
            };

            let html = '<h2>Results:</h2>';
            
            for (const [platform, query] of Object.entries(competitors)) {
                const posts = await fetchRedditData(query);
                const totalUpvotes = posts.reduce((sum, post) => sum + post.ups, 0);
                
                html += `
                    <div class="competitor">
                        <h3>${platform}</h3>
                        <p><strong>Reddit Mentions:</strong> ${posts.length}</p>
                        <p><strong>Total Upvotes:</strong> ${totalUpvotes}</p>
                        <p><strong>Top Discussion:</strong> ${posts[0]?.title || 'No recent posts'}</p>
                    </div>
                `;
                
                // Wait a bit between requests
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            
            document.getElementById('results').innerHTML = html;
        }
    </script>
</body>
</html>
